(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))n(t);new MutationObserver(t=>{for(const c of t)if(c.type==="childList")for(const s of c.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function o(t){const c={};return t.integrity&&(c.integrity=t.integrity),t.referrerpolicy&&(c.referrerPolicy=t.referrerpolicy),t.crossorigin==="use-credentials"?c.credentials="include":t.crossorigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function n(t){if(t.ep)return;t.ep=!0;const c=o(t);fetch(t.href,c)}})();const P=async()=>{const r=document.querySelector("section.cart input.cep-input"),e=`https://cep.awesomeapi.com.br/json/${r.value}`,o=`https://brasilapi.com.br/api/cep/v2/${r.value}`;let n;return await Promise.any([fetch(e),fetch(o)]).then(t=>t.json()).then(t=>{if(t.cep)n=`${t.address} - ${t.district} - ${t.city} - ${t.state}`||`${t.street} - ${t.neighborhood} - ${t.city} - ${t.state}`;else throw new Error("CEP n\xE3o encontrado")}),n},w=async()=>{try{const r=await P(),e=document.querySelector(".cart__address");e.innerHTML=r}catch{const e=document.querySelector(".cart__address");e.innerHTML="CEP n\xE3o encontrado"}};const m=()=>{const r=localStorage.getItem("cartProducts");return r?JSON.parse(r):[]},S=r=>{if(!r)throw new Error("Voc\xEA deve fornecer um ID");const o=[...m(),r];localStorage.setItem("cartProducts",JSON.stringify(o))},I=r=>{if(!r)throw new Error("Voc\xEA deve fornecer um ID");const e=[...m()],o=e.indexOf(r);e.splice(o,1),localStorage.setItem("cartProducts",JSON.stringify(e))},y=async r=>{if(!r)throw new Error("ID n\xE3o informado");const e=`https://api.mercadolibre.com/items/${r}`;return await fetch(e).then(n=>n.json())},L=async r=>{if(!r)throw new Error("Termo de busca n\xE3o informado");const e=`https://api.mercadolibre.com/sites/MLB/search?q=${r}`,o=await fetch(e).then(t=>t.json()),{results:n}=o;return n},h=async()=>{const r=document.querySelector(".total-price");let e=0;document.querySelectorAll("li div span.product__price__value").forEach(n=>{e+=Number(n.innerHTML)}),r.innerText=e},p=r=>{const e=document.createElement("img");return e.className="product__image",e.src=r.replace("I.jpg","O.jpg"),e},a=(r,e,o="")=>{const n=document.createElement(r);return n.className=e,n.innerText=o,n},N=(r,e)=>{r.remove(),I(e),h()},v=({id:r,title:e,price:o,pictures:n})=>{const t=document.createElement("li");t.className="cart__product";const c=a("div","cart__product__image-container"),s=p(n[0].url);c.appendChild(s);const d=p((n[1]||n[0]).url);c.appendChild(d),t.appendChild(c);const i=a("div","cart__product__info-container");i.appendChild(a("span","product__title",e));const l=a("span","product__price","R$ ");l.appendChild(a("span","product__price__value",o)),i.appendChild(l),t.appendChild(i);const _=a("i","material-icons cart__product__remove","delete");return t.appendChild(_),t.addEventListener("click",()=>N(t,r)),t},b=({id:r,title:e,thumbnail:o,price:n})=>{const t=document.createElement("section");t.className="product",t.appendChild(a("span","product__id",r));const c=a("div","img__container");c.appendChild(p(o)),t.appendChild(c),t.appendChild(a("span","product__title",e));const s=a("span","product__price","R$ ");s.appendChild(a("span","product__price__value",n)),t.appendChild(s);const d=a("button","product__add","Adicionar ao carrinho!");return d.addEventListener("click",async i=>{const l=document.querySelector(".cart__products"),f=i.target.parentNode.firstElementChild.innerText,E=v(await y(f));l.appendChild(E),S(f),h()}),t.appendChild(d),t};window.onload=async()=>{const r=m(),e=await Promise.all(r.map(n=>y(n))).then(n=>n),o=document.querySelector(".cart__products");await e.forEach(n=>o.appendChild(v(n))),h()};document.querySelector(".cep-button").addEventListener("click",w);const u=document.querySelector(".products"),g=r=>{const e=document.createElement("div");return r?(e.className="error",e.innerText="Algum erro ocorreu, recarregue a p\xE1gina e tente novamente",u.append(e)):(e.className="loading",e.innerText="carregando...",u.append(e))},C=()=>{const r=document.querySelector(".loading");u.removeChild(r)},$=async()=>{g();const r=await L("computador").catch(e=>(C(),g(e)));return C(),r.forEach(e=>{const o=b(e);u.appendChild(o)})};$();
